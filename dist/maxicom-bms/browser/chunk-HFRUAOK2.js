import{a as it,b as ot}from"./chunk-QZFZEXL4.js";import{a as nt}from"./chunk-ZCLD5EY5.js";import"./chunk-RWFDCCSP.js";import{a as tt,b as et}from"./chunk-B4LNXPXW.js";import"./chunk-L26O6Y2M.js";import{a as U,b as X,c as Z}from"./chunk-EYZQD4T5.js";import{a as z,b as $,c as j,d as H,e as R,f as q}from"./chunk-KJHVRK6L.js";import{a as y}from"./chunk-5DZ3LLXB.js";import{A as g,C as A,D,G as T,J as V,K as B,M as G,N as L,P as W,Q as Y,R as J,S as K,V as Q,y as F}from"./chunk-A7CVY6IQ.js";import{i as b,j as S,ma as O,n as P,na as N,va as E,wa as I}from"./chunk-4PO2YNOU.js";import{Cb as l,Lb as i,Mb as n,Nb as p,Rb as x,Vb as w,Wb as c,cb as d,ec as o,gc as k,hb as u,ma as h,na as M,ob as v,ub as f}from"./chunk-OB35JHSB.js";import{a as _,b as C}from"./chunk-C6Q5SG76.js";function at(a,e){a&1&&(i(0,"div",8),p(1,"mat-spinner"),i(2,"p"),o(3,"Loading Network configuration..."),n()())}function mt(a,e){a&1&&(i(0,"mat-error"),o(1," Invalid IP format "),n())}function st(a,e){if(a&1){let t=x();i(0,"form",13)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),o(4,"settings_ethernet"),n(),o(5),n()(),i(6,"mat-card-content",14)(7,"div",15)(8,"mat-slide-toggle",16)(9,"span",17)(10,"mat-icon"),o(11,"autorenew"),n(),o(12," Auto (DHCP) "),n()()(),i(13,"div",18)(14,"mat-form-field",19)(15,"mat-label"),o(16,"IP Address"),n(),p(17,"input",20),i(18,"mat-icon",21),o(19,"location_on"),n(),f(20,mt,2,0,"mat-error",22),n()(),i(21,"div",18)(22,"mat-form-field",19)(23,"mat-label"),o(24,"Subnet Mask"),n(),p(25,"input",23),i(26,"mat-icon",21),o(27,"mask"),n()()(),i(28,"div",18)(29,"mat-form-field",19)(30,"mat-label"),o(31,"Gateway"),n(),p(32,"input",24),i(33,"mat-icon",21),o(34,"router"),n()()(),i(35,"div",18)(36,"mat-form-field",19)(37,"mat-label"),o(38,"DNS Servers"),n(),p(39,"input",25),i(40,"mat-icon",21),o(41,"dns"),n(),i(42,"mat-hint"),o(43,"Separate multiple DNS servers with commas"),n()()()(),i(44,"mat-card-actions",26)(45,"button",27),w("click",function(){h(t);let m=c().$implicit,s=c(2);return M(s.onSave(m.id))}),i(46,"mat-icon"),o(47,"save"),n(),o(48," Save "),n()()()}if(a&2){let t,r=c().$implicit,m=c(2);l("formGroup",m.networkForms[r.id]),d(5),k(" ",r.name," "),d(15),l("ngIf",(t=m.networkForms[r.id].get("ipAddress"))==null||t.errors==null?null:t.errors.pattern),d(25),l("disabled",m.networkForms[r.id].invalid||m.networkForms[r.id].pristine)}}function dt(a,e){if(a&1&&(i(0,"mat-card",11),f(1,st,49,4,"form",12),n()),a&2){let t=e.$implicit,r=c(2);d(),l("ngIf",r.networkForms[t.id])}}function lt(a,e){if(a&1&&(i(0,"div",9),f(1,dt,2,1,"mat-card",10),n()),a&2){let t=c();d(),l("ngForOf",t.networkConfigs)}}var rt=class a{constructor(e,t,r){this.fb=e;this.snackBar=t;this.commService=r}isLoading=!0;networkConfigs=[];networkForms={};ipPattern=/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/;ngOnInit(){this.loadNetworkData()}loadNetworkData(){this.isLoading=!0,this.commService.getNetworkConfigs().subscribe(e=>{this.networkConfigs=e,console.log("Load DHCP settings: ",this.networkConfigs[0].mode),this.buildForms(),this.isLoading=!1},e=>{console.error("Failed to fetch network config",e),this.showMessage("Failed to load Network configuration","error"),this.isLoading=!1})}buildForms(){this.networkForms={},this.networkConfigs.forEach(e=>{let t=this.fb.group({ipAddress:[e.ipAddress||"",[g.required,g.pattern(this.ipPattern)]],subnetMask:[e.subnetMask||"",[g.required,g.pattern(this.ipPattern)]],gateway:[e.gateway||"",[g.pattern(this.ipPattern)]],dns:[e.dns||""],dhcp:[e.mode||""],dhcpEnabled:[e.mode==="dhcp"]}),r=t.get("dhcp")?.value;t.get("dhcpEnabled")?.valueChanges.subscribe(m=>{this.toggleStaticIpValidators(t,m??!1)}),this.networkForms[e.id]=t})}toggleStaticIpValidators(e,t){["ipAddress","subnetMask","gateway","dns"].forEach(m=>{let s=e.get(m);t?s?.disable():s?.enable()})}onSave(e){let t=this.networkForms[e];if(t.invalid){this.showMessage("Please check the configuration information","error"),t.markAllAsTouched();return}let r=t.getRawValue(),m=C(_(_({},this.networkConfigs.find(s=>s.id===e)),t.getRawValue()),{ipAddress:r.ipAddress,subnetMask:r.subnetMask,gateway:r.gateway,dns:r.dns,mode:r.dhcpEnabled?"dhcp":"static"});t.disable(),this.commService.saveNetworkConfig(m).subscribe(s=>{this.showMessage("Saved","success"),this.loadNetworkData()},s=>{this.showMessage("Error saving configuration","error"),console.error("Save failed",s),t.enable(),this.toggleStaticIpValidators(t,t.get("dhcp")?.value??!1)})}showMessage(e,t){this.snackBar.open(e,"Close",{duration:3e3,panelClass:[`${t}-snackbar`]})}static \u0275fac=function(t){return new(t||a)(u(G),u(y),u(nt))};static \u0275cmp=v({type:a,selectors:[["app-network"]],decls:11,vars:2,consts:[[1,"network-container"],[1,"page-header"],[1,"header-content"],[1,"page-title"],[1,"title-icon"],[1,"page-subtitle"],["class","loading-spinner",4,"ngIf"],["class","content-grid",4,"ngIf"],[1,"loading-spinner"],[1,"content-grid"],["class","config-card mat-elevation-z4",4,"ngFor","ngForOf"],[1,"config-card","mat-elevation-z4"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"config-form"],[1,"dhcp-toggle"],["formControlName","dhcpEnabled"],[1,"toggle-label"],[1,"form-row"],["appearance","outline",1,"form-field"],["matInput","","formControlName","ipAddress","placeholder"," "],["matSuffix",""],[4,"ngIf"],["matInput","","formControlName","subnetMask","placeholder"," "],["matInput","","formControlName","gateway","placeholder"," "],["matInput","","formControlName","dns","placeholder","8.8.8.8,1.1.1.1"],["align","end"],["mat-flat-button","","color","primary",3,"click","disabled"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3)(4,"mat-icon",4),o(5,"wifi"),n(),o(6," Network Communication "),n(),i(7,"p",5),o(8," Configure Ethernet network ports (WAN 0, WAN 1) "),n()()(),f(9,at,4,0,"div",6)(10,lt,2,1,"div",7),n()),t&2&&(d(9),l("ngIf",r.isLoading),d(),l("ngIf",!r.isLoading))},dependencies:[P,b,S,L,T,F,A,D,V,B,q,z,H,j,R,$,I,E,N,O,U,Q,W,J,Y,K,Z,X,ot,it,et,tt],styles:[".network-container[_ngcontent-%COMP%]{min-height:calc(100vh - var(--header-height) - 48px);animation:_ngcontent-%COMP%_fadeIn .5s ease-in}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{margin:0 0 8px;display:flex;align-items:center;gap:12px;color:var(--primary-color);font-size:1.8rem;font-weight:500}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--accent-color)}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{margin:0;color:#666;font-size:1rem;line-height:1.5}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;gap:16px;color:#0009}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:24px}.config-card[_ngcontent-%COMP%]{border-radius:16px;box-shadow:0 4px 20px #00000014}.config-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);padding:20px 24px;border-bottom:1px solid #e0e0e0}.config-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;color:var(--primary-color);font-size:1.2rem;font-weight:500;margin:0}.config-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.config-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{padding:0 24px 24px}.config-form[_ngcontent-%COMP%]   .dhcp-toggle[_ngcontent-%COMP%]{margin-bottom:24px}.config-form[_ngcontent-%COMP%]   .dhcp-toggle[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.config-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{margin-bottom:16px}.config-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{width:100%}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};export{rt as NetworkComponent};
